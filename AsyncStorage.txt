import React, { useState } from "react";
import { View, TextInput, Button, Alert } from "react-native";
import AsyncStorage from '@react-native-async-storage/async-storage';

function App() {
  // create two state variables to store the input values
  const [inputValueOne, setInputValueOne] = useState("");
  const [inputValueTwo, setInputValueTwo] = useState("");

  // create another state variable to store the button title
  const [buttonTitle, setButtonTitle] = useState("Get Input Value");

  // update the input value state variables when the input values change
  const handleChangeOne = (text) => {
    setInputValueOne(text);
  };

  const handleChangeTwo = (text) => {
    setInputValueTwo(text);
  };

  // update the button title state variable with the input values on button press
  const handlePress = () => {
    // call the StoreGuestData function with the input values as arguments
    StoreGuestData(inputValueOne, inputValueTwo);
  };

  // define the StoreGuestData function
  const StoreGuestData = async (valueOne, valueTwo) => {
    // check if both values are not empty
    if (valueOne !== "" && valueTwo !== "") {
      // set the button title to the input values
      setButtonTitle(valueOne + " " + valueTwo);
      // insert the input values into the storage
      try {
        // stringify the input values and store them as an array
        await AsyncStorage.setItem('users', JSON.stringify([valueOne, valueTwo]));
        console.log('Data inserted successfully');
      } catch (error) {
        // handle error
        console.log('Error occurred while inserting data:', error.message);
        Alert.alert('Error', error.message);
      }
      
    } else {
      // set the button title to "N/A"
      setButtonTitle("N/A");
    }
  };

  // define the GetGuestData function
  const GetGuestData = async () => {
    // fetch the data from the storage
    try {
      const value = await AsyncStorage.getItem('users');
      if (value !== null) {
        // parse the value and return it as an array
        return JSON.parse(value);
      }
    } catch (error) {
      // handle error
      console.log('Error occurred while fetching data:', error.message);
      Alert.alert('Error', error.message);
    }
  };

  return (
    <View style={{ flex: 1, alignItems: "center", justifyContent: "center" }}>
      <TextInput
        style={{ width: 200, height: 40, borderColor: "gray", borderWidth: 1 }}
        placeholder="Enter some text"
        onChangeText={handleChangeOne}
      />
      <TextInput
        style={{ width: 200, height: 40, borderColor: "gray", borderWidth: 1 }}
        placeholder="Enter some text"
        onChangeText={handleChangeTwo}
      />
      <Button title={buttonTitle} onPress={handlePress} />
    </View>
  );
}

export default App;
